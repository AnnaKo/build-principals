apply plugin: 'java'

jar {
    baseName = 'hello'
    project.version = v
    manifest {
        attributes "Main-Class": "com.test.Project"
    }
}

repositories {
    mavenCentral()
}

dependencies {
    compile group: 'commons-collections', name: 'commons-collections', version: '3.0'
    compile group: 'log4j', name: 'log4j', version: '1.2.16'
    testCompile 'junit:junit:4.12'
    compile 'junit:junit:4.12'
}

task tgzArtifacts(type: Tar) {
    baseName = 'hello'
    into ('/'){
        from 'build/libs'
        include '*.jar'
    }
    extension = 'tar.gz'
    compression = Compression.GZIP
    }

artifacts {
    archives tgzArtifacts
}

task hello(dependsOn: 'test') {
    doLast {
        logger.quiet "My task Hello"
        logger.quiet ""
        logger.quiet "Name and path to tgz: " + relativePath(tgzArtifacts.archivePath)
        logger.quiet "My Gradle version is $gradle.gradleVersion"
    }
}

build{
    doFirst {
        logger.quiet "My task build"
    }
    check.dependsOn.remove(test)
}

task test(type: Test, overwrite: true){
    doFirst {
        logger.quiet "My task Test"
    }
    test.dependsOn build
    useJUnit {
        include '**/*UnitTest*'
    }
    afterTest {
        desc, result ->
        logger.quiet "UnitTest - ${desc.name} result: ${result.resultType}"
    }
}
